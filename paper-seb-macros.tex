% These macros allow the paper and the supplementary material to share a single sequence of bibliography citations

\usepackage[hyphens]{url}
\usepackage{hyperref}
\usepackage{xcolor}
\usepackage{longtable}
\usepackage{cite}

\renewcommand\thesubsection{\thesection.\alph{subsection}}
\renewcommand\thesubsubsection{\thesection.\alph{subsection}.\arabic{subsubsection}}

\def\httpURL#1{\href{http://#1}{\textcolor{blue}{#1}}}
\def\LONGhttpURL#1#2{\href{http://#1}{\textcolor{blue}{#2}}}

\makeatletter
    \def\do@url@hyp{\do/}
    \usepackage{moreverb}
   % \def\@seccntformat#1{\csname the#1\endcsname\quad}
\makeatother

\DeclareUrlCommand\doi{\def\UrlLeft{{\textrm{DOI }} }}
\DeclareUrlCommand\url{\def\UrlLeft{{\textrm{URL }} }}
\DeclareUrlCommand\midurl{\def\UrlLeft{}\allowbreak }
	
%\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\renewcommand{\thefootnote}{\arabic{footnote}}

\def\mytitle{Improving science that uses code}

\def\citeeg#1{[e.g., \citenum{#1}]}

\def\inputifexists#1#2{\IfFileExists{#1}{\input{#1}}{\typeout{No file #1. #2}}}

% calculate percentages
\newcount \t
\newcount \tu
\def\pc#1#2{\t = #1%
\multiply \t by 100000%
\divide \t by #2% ?? 0 times percentage
\tu = \t
\divide \t by 1000% percentage, but no idea of remainder
\multiply \t by 1000% 1000 times percentage, with 00 as bottom digits
\advance \tu by -\t% bottom two digits
\divide \t by 1000\relax%
% round to nearest integer
% if ending in > .5 round up
% if ending in exactly .5 round towards nearest even number
\ifnum \tu > 500 % round up
	\advance \t by 1 
\else
	\ifnum \tu = 500 
		\ifodd \t % it's odd, so round up to even number 
			\advance \t by 1
		\else % leave rounded to even number 	
		\fi
	\fi
\fi
\the\t\%}

% insert commas into large numbers (integers)
\def\commarise#1{%[#1]
	\t=#1
    \divide \t by 1000
    \ifnum \t > 0
    	\the\t,%
    	\tu=#1
    	\multiply \t by 1000
    	\advance \tu by -\t
		\ifnum \tu < 100 0\fi
		\ifnum \tu < 10 0\fi
		\the\tu
    \else
    	#1%
    \fi
}

% simple macro to use a number register to pluralize (add an s) to words....
% \plural{\t}{fred} => \the\t\ freds if plural, or => one fred if singular
\def\plural#1#2{\ifnum #1=1 
	one #2%
\else
	\the#1\ #2s%
\fi}

% initialiseBibliography <title> <starting number> <introductory text>
\newcount \bibciten \bibciten=0
\def\initialiseBibliography#1#2#3{%
	\stepcounter{section}
	\global\def\refname{\arabic{section} #1}
    \global\def\unnumberedrefname{#1}
    \global\bibciten=#2
    \global\def\startBibliography{#3}
}

\def\bibskip{\vskip 1ex} % the gap between bib items generated by data.js

% read in any constants defined from the JSON or Git data
\input generated/constants.tex
\input generated/metadata.tex
\input generated/covidsimSummary.tex

% calculation used in table-repo-summary in main.tex, and also referred to in supplement.tex as an example calculation
% paper submitted June 2019, published April 2020

\input generated/clone-date.tex
\newcount \pubdelayinmonths
\pubdelayinmonths=\cloneyear
\advance \pubdelayinmonths by -2019 % submitted in 2019
\multiply \pubdelayinmonths by 12
\advance \pubdelayinmonths by -6 % submitted in June
\advance \pubdelayinmonths by \clonemonth

\def\monthname#1{\ifcase#1 \or 
January\or 
February\or 
March\or 
April\or 
May\or 
June\or 
July\or 
August\or 
September\or 
October\or 
November\or 
December\fi}

\def\numbertoname#1{\ifcase #1 zero\or one\or two\or three\or four\or five\or six\or seven\or eight\or nine\else #1\fi}
\def\Numbertoname#1{\ifcase #1 Zero\or One\or Two\or Three\or Four\or Five\or Six\or Seven\or Eight\or Nine\else #1\fi}

\def\clonewhen{\monthname{\clonemonth} \cloneyear}

\newenvironment{change}
	{\color{black}}
	{\color{black}}

\def\RAPstar{RAP{\tt +}}
\def\RAPstars{RAPs{\tt +}}
\def\RAPstarp#1{RAP{\tt +}#1}
\def\italicRAPstar{RAP{\tt +}}

\def\supplement{Supplemental Material}

\makeatletter
\def\remembernamevalue#1#2{\immediate\write\@auxout{\@backslashchar gdef\@backslashchar #1{#2}}}
\makeatother

